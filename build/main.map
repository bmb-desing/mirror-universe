{"version":3,"sources":["webpack:///webpack/bootstrap 2263d04e4e7c1ef624ab","webpack:///external \"express\"","webpack:///./server/model/index.js","webpack:///external \"dotenv\"","webpack:///./server/index.js","webpack:///external \"nuxt\"","webpack:///external \"sequelize\"","webpack:///external \"striptags\"","webpack:///external \"node-schedule\"","webpack:///./server/parser/index.js","webpack:///external \"needle\"","webpack:///external \"transliteration\"","webpack:///external \"mkdirp\"","webpack:///external \"cheerio\"","webpack:///external \"request\"","webpack:///external \"url\"","webpack:///external \"fs\"","webpack:///external \"body-parser\"","webpack:///external \"express-session\"","webpack:///./server/api/index.js","webpack:///./server/api/users.js","webpack:///./server/api/category.js","webpack:///./server/api/posts.js","webpack:///./server/mails/askMail.js","webpack:///external \"nodemailer\"","webpack:///external \"connect-session-sequelize\"","webpack:///./nuxt.config.js","webpack:///external \"axios\""],"names":["require","config","sequelize","process","env","DB_NAME","DB_USER","DB_PASSWORD","host","dialect","timezone","category","define","title","Sequelize","STRING","description","TEXT","alias","type","unique","thumbnail","post","text","allowNull","shortText","rating","INTEGER","defaultValue","ratingCount","visits","telegramSend","BOOLEAN","hooks","beforeCreate","striptags","substr","beforeUpdate","comment","name","parent_id","hasMany","belongsTo","SequelizeStore","session","Store","app","express","HOST","port","PORT","sessionStore","db","checkExpirationInterval","expiration","set","use","bodyParser","json","secret","resave","saveUninitialized","store","dev","nuxt","builder","build","render","listen","shedule","scheduleJob","minute","parser","console","log","url","needle","get","err","res","$","cheerio","load","body","contents","find","i","el","itemParse","itemTitle","findOne","where","then","postItem","link","parent","attr","fullLink","resolve","parsePage","decodeEntities","html","cat","content","catId","id","getThumbnail","parseText","slugify","create","catch","e","img","each","index","path","pathArr","split","nameFile","pop","splice","image","download","uri","filepath","callback","join","mkdirp","filename","request","head","multipart","pipe","fs","createWriteStream","on","message","eq","router","Router","req","next","pages","findAll","include","model","cats","map","posts","push","users","parseInt","params","length","sendStatus","categories","limit","order","attributes","findAndCountAll","offset","query","page","count","rows","item","postId","comments","fn","rand","indexOf","update","status","com","mail","nodemailer","createTransport","secure","auth","user","pass","askMail","sendMail","from","to","subject","theme","email","error","response","axios","module","exports","cache","modules","plugins","linkActiveClass","sitemap","hostname","cacheTime","generate","routes","data","meta","charset","hid","rel","href","css","src","lang","extractCSS","vendor","extend","ctx"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2263d04e4e7c1ef624ab","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","import Sequelize from 'sequelize'\r\nimport striptags from 'striptags'\r\nrequire('dotenv').config()\r\nexport const sequelize = new Sequelize(process.env.DB_NAME ||'mirror', process.env.DB_USER || 'root', process.env.DB_PASSWORD || '', {\r\n\thost: 'localhost',\r\n\tdialect: 'mysql',\r\n\ttimezone : \"+03:00\"\r\n})\r\nexport const category = sequelize.define('cats', {\r\n\ttitle: Sequelize.STRING,\r\n\tdescription: Sequelize.TEXT,\r\n\talias: {\r\n\t\ttype: Sequelize.STRING, unique: true\r\n\t},\r\n\tthumbnail: Sequelize.STRING\r\n})\r\nexport const post = sequelize.define('posts', {\r\n\ttitle: Sequelize.STRING,\r\n\tdescription: Sequelize.TEXT,\r\n\talias: {\r\n\t\ttype: Sequelize.STRING, unique: true\r\n\t},\r\n\tthumbnail: Sequelize.STRING,\r\n\ttext: {\r\n\t\ttype: Sequelize.TEXT, allowNull: false\r\n\t},\r\n\tshortText: {\r\n        type: Sequelize.TEXT\r\n\t},\r\n\trating: {\r\n\t\ttype: Sequelize.INTEGER, defaultValue: 0\r\n\t},\r\n\tratingCount: {\r\n        type: Sequelize.INTEGER, defaultValue: 0\r\n\t},\r\n\tvisits: {\r\n\t\ttype: Sequelize.INTEGER, defaultValue: 0\r\n\t},\r\n\ttelegramSend: {\r\n\t\ttype: Sequelize.BOOLEAN, defaultValue: 0\r\n\t}\r\n}, {\r\n\thooks: {\r\n\t\tbeforeCreate: (post) => {\r\n\t\t\tconst shortText = striptags(post.text)\r\n\t\t\treturn post.shortText = shortText.substr(0 , 250)\r\n\t\t},\r\n\t\tbeforeUpdate: (post) => {\r\n            const shortText = striptags(post.text)\r\n            return post.shortText = shortText.substr(0 , 250)\r\n\t\t}\r\n\t}\r\n})\r\nexport const comment = sequelize.define('comments', {\r\n\tname: {\r\n\t\ttype: Sequelize.STRING, allowNull: false\r\n\t},\r\n\ttext: {\r\n\t\ttype: Sequelize.TEXT, allowNull: false\r\n\t},\r\n\tparent_id: {\r\n\t\ttype: Sequelize.INTEGER, defaultValue: 0\r\n\t}\r\n})\r\ncategory.hasMany(post)\r\npost.belongsTo(category)\r\npost.hasMany(comment)\r\ncomment.belongsTo(post)\r\nexport default sequelize\n\n\n// WEBPACK FOOTER //\n// ./server/model/index.js","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 2\n// module chunks = 0","require('dotenv').config()\r\nimport express from 'express'\r\nimport { Nuxt, Builder } from 'nuxt'\r\nimport database from './model/index'\r\nimport shedule from 'node-schedule'\r\nimport parser from './parser'\r\nimport bodyParser from 'body-parser'\r\nimport session from 'express-session'\r\nimport api from './api'\r\n//import bot, {telPost} from './telegram'\r\nconst SequelizeStore = require('connect-session-sequelize')(session.Store)\r\nconst app = express()\r\nconst host = process.env.HOST || '127.0.0.1'\r\nconst port = process.env.PORT || 3000\r\nconst sessionStore = new SequelizeStore({\r\n  db: database,\r\n\tcheckExpirationInterval: 15 * 60 * 1000,\r\n\texpiration: 7 * 24 * 60 * 60 * 1000\r\n})\r\napp.set('port', port)\r\napp.use(bodyParser.json())\r\napp.use(session({\r\n    secret: 'super-secret-key',\r\n    resave: false,\r\n    saveUninitialized: true,\r\n\t  store: sessionStore\r\n}))\r\n// Import API Routes\r\napp.use('/api', api)\r\n\r\n\r\n// Import and Set Nuxt.js options\r\nlet config = require('../nuxt.config.js')\r\nconfig.dev = !(process.env.NODE_ENV === 'production')\r\n// Init Nuxt.js\r\nconst nuxt = new Nuxt(config)\r\n// Build only in dev mode\r\nif (config.dev) {\r\n  const builder = new Builder(nuxt)\r\n  builder.build()\r\n}\r\n// Give nuxt middleware to express\r\napp.use(nuxt.render)\r\n// Listen the server\r\napp.listen(port, host)\r\nshedule.scheduleJob({minute: '0' }, function () {\r\n    parser()\r\n    //telPost()\r\n})\r\n\r\nconsole.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"striptags\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"striptags\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"node-schedule\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-schedule\"\n// module id = 7\n// module chunks = 0","import needle from 'needle'\r\nimport { slugify } from 'transliteration'\r\nimport mkdirp from 'mkdirp'\r\nimport cheerio from 'cheerio'\r\nimport {post, category} from '../model'\r\nimport request from 'request'\r\nimport {resolve} from 'url'\r\nimport fs from 'fs'\r\nconst url = 'http://tabula-rasa24.ru/'\r\nconst parser = () => needle.get(url, function (err, res) {\r\n    if (err) throw err\r\n    const $ = cheerio.load(res.body);\r\n    var text = $('.sidebar-1 .itemsList .moduleItemIntro').contents()\r\n    var title = text.find('.moduleItemTitle').contents().text(function (i, el) {\r\n        var itemParse = $(this)\r\n        var itemTitle = $(this).text()\r\n        post.findOne(\r\n            {\r\n                where:\r\n                    {\r\n                        title: itemTitle\r\n                    }\r\n            }\r\n        ).then(postItem => {\r\n            if (postItem == null) {\r\n                var link = itemParse.parent().attr('href')\r\n                const fullLink = resolve(url, link)\r\n                needle.get(fullLink, {json: true} , function (err, res) {\r\n                    if (err) throw err\r\n                    parsePage(res)\r\n                })\r\n            }\r\n        })\r\n\r\n    })\r\n})\r\n\r\nfunction parsePage(res) {\r\n\r\n\tconst $ = cheerio.load(res.body, { decodeEntities: false });\r\n\tconst title = $('head title').text()\r\n\tconst description = $('meta[property=\"og:description\"]').attr('content')\r\n\tconst text = $('.itemFullText').html()\r\n\tcategory.findOne({where: {title : $('.itemCategory a').text()}}).then(cat => {\r\n\t\tif (cat) {\r\n\t\t\tconst content = {}\r\n\t\t\tcontent.catId = cat.id\r\n\t\t\tcontent.title = title\r\n\t\t\tcontent.thumbnail = getThumbnail(text)\r\n\t\t\tcontent.text = parseText(text)\r\n\t\t\tcontent.alias = slugify(title)\r\n\t\t\tcontent.description = description\r\n\r\n\t\t\tpost.create(content).then(console.log('Пост успешно добавлен')).catch((e) => {\r\n\t\t\t    console.log(e)\r\n            })\r\n\t\t}\r\n\t})\r\n}\r\nfunction parseText(text) {\r\n    const $ = cheerio.load(text)\r\n\tconst img = $('img').each(function (index, el) {\r\n\t\tconst path = $(this).attr('src')\r\n        const pathArr = path.split('/')\r\n\t\tconst nameFile = pathArr.pop()\r\n        pathArr.splice(0,1)\r\n\t\tconst image = download(resolve(url, path), pathArr, nameFile, function(){\r\n\t\t})\r\n    })\r\n\treturn text\r\n}\r\nfunction download(uri, filepath, name, callback){\r\n\tconst path = 'static/'+ filepath.join('/')\r\n\tmkdirp(path, function (err) {\r\n\t\tif (err) throw err\r\n    })\r\n\tconst filename = path + '/' + name\r\n\r\n    request.head(uri, function(err, res, body){\r\n        needle.get(uri, {multipart: true}).pipe(\r\n            fs.createWriteStream(filename)\r\n                .on('open', (path) => {\r\n                    console.log(path)\r\n                }).on('error', (err) => {\r\n                    console.log(err)\r\n                })\r\n        ).on('finish', (err) => {\r\n            if (err) console.log('An error ocurred: ' + err.message)\r\n            else console.log('Изображение загруженно')\r\n        }).on('error', (err) => {\r\n            console.log(err)\r\n        })\r\n    });\r\n}\r\nfunction getThumbnail(text) {\r\n    const $ = cheerio.load(text)\r\n    const path = $('img').eq(0).attr('src')\r\n    return path\r\n}\r\nexport default parser\n\n\n// WEBPACK FOOTER //\n// ./server/parser/index.js","module.exports = require(\"needle\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"needle\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"transliteration\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"transliteration\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"mkdirp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mkdirp\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cheerio\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cheerio\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"url\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"url\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 17\n// module chunks = 0","import { Router } from 'express'\r\n\r\nimport users from './users'\r\nimport categories from './category'\r\nimport posts from './posts'\r\nimport {category, post} from \"../model\";\r\nconst router = Router()\r\n// Add USERS Routes\r\nrouter.use(users)\r\nrouter.use(categories)\r\nrouter.use(posts)\r\nrouter.get('/sitemap', function (req, res, next) {\r\n    var pages = []\r\n    category.findAll({include: [{model: post}]}).then(cats => {\r\n        cats.map(cat => {\r\n            cat.posts.map(post => {\r\n                return pages.push('/' + cat.alias + '/' + post.alias)\r\n            })\r\n            return pages.push('/' + cat.alias)\r\n\r\n        })\r\n        res.json(pages)\r\n\r\n    })\r\n})\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/index.js","import { Router } from 'express'\r\n\r\nconst router = Router()\r\n\r\n// Mock Users\r\nconst users = [\r\n  { name: 'Alexandre' },\r\n  { name: 'Pooya' },\r\n  { name: 'Sébastien' },\r\n]\r\n\r\n/* GET users listing. */\r\nrouter.get('/users', function (req, res, next) {\r\n  res.json(users)\r\n})\r\n\r\n/* GET user by ID. */\r\nrouter.get('/users/:id', function (req, res, next) {\r\n  const id = parseInt(req.params.id)\r\n  if (id >= 0 && id < users.length) {\r\n    res.json(users[id])\r\n  } else {\r\n    res.sendStatus(404)\r\n  }\r\n})\r\n\r\n\r\nexport default router\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/users.js","import { Router } from 'express'\r\nimport {category} from \"../model\"\r\n\r\nconst router = Router()\r\n\r\n\r\nrouter.get('/categories', function (req, res, next) {\r\n\tcategory.findAll().then(categories => {\r\n\t\tres.json(categories)\r\n\t})\r\n})\r\n\r\n\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/api/category.js","import { Router } from 'express'\r\nimport {post, category, sequelize, comment} from \"../model\";\r\nimport {askMail} from \"../mails/askMail\";\r\nconst router = Router()\r\n\r\nrouter.get('/post-index', function (req, res, next) {\r\n    post.findAll({limit: 7, order: [['createdAt', 'DESC']],  include: [{model:category}, {model:comment, attributes: ['id']}]}).then((posts) => {\r\n        res.json(posts)\r\n    })\r\n})\r\nrouter.get('/posts', function (req, res, next) {\r\n    post.findAndCountAll({ limit: 7, offset: 7 * (req.query.page-1 || 0), include: [{model: category},{model:comment, attributes: ['id']}] , order: [['createdAt', 'DESC']]}).then(posts => {\r\n        if (req.query.page <= parseInt(posts.count/7)) {\r\n            res.json({posts: posts.rows, count: parseInt(posts.count / 7)})\r\n        }\r\n        else {\r\n            res.sendStatus(404)\r\n        }\r\n    })\r\n})\r\nrouter.get('/post/:category', function (req,res,next) {\r\n    category.findOne({\r\n        where: {\r\n            alias: req.params.category\r\n        }\r\n    }).then(cat => {\r\n        if(cat) {\r\n            post.findAndCountAll({where: {catId: cat.id }, include: [{model:category}, {model:comment, attributes: ['id']}], limit: 7, offset: 7 * (req.query.page-1 || 0) , order: [['createdAt', 'DESC']]}).then(posts => {\r\n                const count = parseInt(posts.count/7)\r\n                res.json({posts: posts.rows, count: count, cat: cat})\r\n            })\r\n        }\r\n        else {\r\n            res.sendStatus(404)\r\n        }\r\n    })\r\n})\r\nrouter.get('/post/:category/:post', function (req, res, next) {\r\n    post.findOne(\r\n        {\r\n            where:\r\n                {\r\n                    alias: req.params.post\r\n                },\r\n            include: [\r\n                {\r\n                    model: category,\r\n                    where:\r\n                        {\r\n                            alias: req.params.category\r\n                        }\r\n                }\r\n                ]\r\n        }).then((item) => {\r\n        if (item) {\r\n            comment.findAll(\r\n                {\r\n                    where:\r\n                    {\r\n                        postId: item.id\r\n                    }\r\n                }).then((comments) => {\r\n                post.findAll({where: {catId: item.catId }, order: [[sequelize.fn(('RAND'))]], limit: 2}).then((rand) => {\r\n                    res.json({post: item, rand: rand, comments: comments})\r\n                })\r\n            })\r\n\r\n\r\n        }\r\n        else {\r\n            res.sendStatus(404)\r\n        }\r\n    })\r\n})\r\nrouter.post('/addRating', function (req,res,next) {\r\n    if (!req.session.rating) {\r\n        req.session.rating = []\r\n    }\r\n    if (req.session.rating.indexOf(req.body.id) == -1) {\r\n        post.findOne({where: {id: req.body.id}}).then((item) => {\r\n            if (item) {\r\n                const count = item.ratingCount + 1\r\n                const rating= req.body.rating + item.rating\r\n                item.update({\r\n                    rating: rating,\r\n                    ratingCount: count\r\n                }).then((status) => {\r\n                    req.session.rating.push(req.body.id)\r\n                    res.json(req.body.id)\r\n                })\r\n            }\r\n            else {\r\n                res.sendStatus(404)\r\n            }\r\n        })\r\n    }\r\n    else {\r\n        res.sendStatus(403)\r\n    }\r\n})\r\nrouter.post('/addVisit', function (req,res,next) {\r\n\tif (!req.session.visits) {\r\n\t\treq.session.visits = []\r\n\t}\r\n\tif (req.session.visits.indexOf(req.body.id) == -1) {\r\n\t\tpost.findOne({where: {id: req.body.id}}).then((item) => {\r\n\t\t\tif (item) {\r\n\t\t\t\tconst count = item.visits + 1\r\n\t\t\t\titem.update({\r\n\t\t\t\t\tvisits: count\r\n\t\t\t\t}).then((status) => {\r\n\t\t\t\t\treq.session.visits.push(req.body.id)\r\n\t\t\t\t\tres.json(req.body.id)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tres.sendStatus(404)\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\telse {\r\n\t\tres.sendStatus(403)\r\n\t}\r\n})\r\nrouter.post('/addComment', function (req, res, next) {\r\n    comment.create({\r\n        name: req.body.name,\r\n        text: req.body.text,\r\n        postId: req.body.postId,\r\n        parent_id: req.body.parent_id\r\n    }).then((comment) => {\r\n        res.json(comment)\r\n    }).catch((err) => {\r\n        res.sendStatus(403)\r\n    })\r\n})\r\nrouter.get('/sidebar', function (req, res, next) {\r\n  post.findAll({\r\n\t\torder: [['rating', 'DESC']],\r\n\t\tlimit: 3,\r\n    include: [\r\n      {\r\n          model: category\r\n      }\r\n    ]\r\n  }).then(posts => {\r\n      comment.findAll({\r\n\t\t\t\torder: [['createdAt', 'DESC']],\r\n\t\t\t\tlimit: 5,\r\n        include: [\r\n          {\r\n              model: post,\r\n            include: [ {\r\n                  model: category\r\n            }]\r\n          },\r\n        ]\r\n      }).then(com => {\r\n        res.json({\r\n          posts: posts,\r\n          comments: com\r\n        })\r\n      })\r\n  })\r\n})\r\nrouter.post('/ask', askMail)\r\nexport default router\n\n\n// WEBPACK FOOTER //\n// ./server/api/posts.js","import nodemailer from 'nodemailer'\r\nconst mail = nodemailer.createTransport({\r\n\thost: 'smtp.yandex.ru',\r\n\tport: 465,\r\n\tsecure: 'ssl',\r\n\tauth: {\r\n\t\tuser: 'xolms@bmb-design.ru',\r\n\t\tpass: '657216as'\r\n\t}\r\n})\r\nexport const askMail = (req, res, next) => {\r\n\tmail.sendMail({\r\n\t\tfrom: 'xolms@bmb-desing.ru',\r\n\t\tto: 'xolms@bmb-desing.ru',\r\n\t\tsubject: 'Новый вопрос с сайта',\r\n\t\thtml: '<p>С сайта пришел новый вопрос<br/>На тему ' + req.body.theme + '<br/> Имя отправителя: ' + req.body.name + '<br/>E-mail для обратной связи: '+ req.body.email + 'Вопрос: '+ req.body.message + '</p>'\r\n\t}, (error, response) => {\r\n\t\tif (error) {\r\n\t\t\tconsole.log(error)\r\n\t\t\tres.json({status: false, message: 'Ошибка при отправке'})\r\n\t\t}\r\n\t\telse {\r\n\t\t\tres.json({status: true , message: 'Сообщение успешно отправленно'})\r\n\t\t}\r\n\r\n\t})\r\n}\n\n\n// WEBPACK FOOTER //\n// ./server/mails/askMail.js","module.exports = require(\"nodemailer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nodemailer\"\n// module id = 23\n// module chunks = 0","module.exports = require(\"connect-session-sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-session-sequelize\"\n// module id = 24\n// module chunks = 0","const axios = require('axios')\r\nrequire('dotenv').config()\r\nmodule.exports = {\r\n  cache: true,\r\n  /*\r\n  ** Headers of the page\r\n  */\r\n  modules: [\r\n      '@nuxtjs/sitemap'\r\n  ],\r\n    plugins: [\r\n        '~/plugins/period.js'\r\n    ],\r\n  router: {\r\n      linkActiveClass: 'active'\r\n  },\r\n  sitemap: {\r\n      path: '/sitemap.xml',\r\n      hostname: `http://${process.env.HOST || 'localhost'}`,\r\n      cacheTime: 1000 * 60 * 15,\r\n      generate: false, // Enable me when using nuxt generate\r\n\r\n      routes() {\r\n          {\r\n              return axios.get(`http://${process.env.HOST || 'localhost'}:${process.env.PORT || 3000}` + '/api/sitemap').then(res => res.data.map(pages =>  pages))\r\n          }\r\n\r\n      }\r\n  },\r\n  head: {\r\n    title: 'starter',\r\n    meta: [\r\n      { charset: 'utf-8' },\r\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\r\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\r\n    ],\r\n    link: [\r\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },\r\n      { rel: 'stylesheet', href: 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'}\r\n    ]\r\n  },\r\n  /*\r\n  ** Global CSS\r\n  */\r\n  css: [\r\n    '~/assets/css/main.css',\r\n      { src: '~/assets/sass/main.sass', lang: 'sass' },\r\n  ],\r\n  /*\r\n  ** Add axios globally\r\n  */\r\n  build: {\r\n    extractCSS: true,\r\n    vendor: ['axios'],\r\n    /*\r\n    ** Run ESLINT on save\r\n    */\r\n    extend (config, ctx) {\r\n      /*if (ctx.isClient) {\r\n        config.module.rules.push({\r\n          enforce: 'pre',\r\n          test: /\\.(js|vue)$/,\r\n          loader: 'eslint-loader',\r\n          exclude: /(node_modules)/\r\n        })\r\n      }*/\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 26\n// module chunks = 0"],"sourceRoot":""}